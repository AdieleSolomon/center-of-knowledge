<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CENTER OF KNOWLEDGE AND SPIRITUAL ENRICHMENT</title>
    <meta name="description" content="Wisdom for Life, Faith for Eternity - A place for spiritual growth, knowledge acquisition, and faith building">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        
:root {
            --primary: #5D4037; /* Dark wooden brown */
            --secondary: #8D6E63; /* Medium wooden brown */
            --accent: #D7CCC8; /* Light wooden brown for accents */
            --light: #EFEBE9; /* Very light wooden brown */
            --dark: #4E342E; /* Very dark wooden brown */
            --text: #EFEBE9; /* Light text for better contrast */
            --text-light: #D7CCC8; /* Lighter text */
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html {
            scroll-behavior: smooth;
            scroll-padding-top: 120px;
        }

        body {
            padding-top: 120px;
        }

        body {
            font-family: 'Montserrat', sans-serif;
            background: linear-gradient(135deg, #5D4037 0%, #8D6E63 100%);
            color: var(--text);
            line-height: 1.6;
            position: relative;
        }

        .background-pattern {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: url('data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMDAiIGhlaWdodD0iMTAwIiB2aWV3Qm94PSIwIDAgMTAwIDEwMCI+PHJlY3Qgd2lkdGg9IjEwMCIgaGVpZ2h0PSIxMDAiIGZpbGw9IiM1RDQwMzciLz48cGF0aCBkPSJNMCA1MEg1MFYxMDBINHoiIGZpbGw9IiM4RDZFNjMiLz48L3N2Zz4=');
            opacity: 0.1;
            z-index: -1;
        }

        .container {
            width: 90%;
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }

        section {
            padding: 80px 0;
        }

        h1, h2, h3, h4 {
            margin-bottom: 20px;
            color: var(--text);
        }

        h1 {
            font-size: 2.8rem;
            line-height: 1.2;
            text-align: center;
        }

        h2 {
            font-size: 2.2rem;
            text-align: center;
            margin-bottom: 50px;
            position: relative;
        }

        h2:after {
            content: '';
            position: absolute;
            bottom: -15px;
            left: 50%;
            transform: translateX(-50%);
            width: 80px;
            height: 4px;
            background-color: var(--accent);
        }

        p {
            margin-bottom: 15px;
            color: var(--text-light);
        }

        .btn {
            display: inline-block;
            padding: 12px 30px;
            background-color: var(--accent);
            color: var(--primary);
            border: none;
            border-radius: 5px;
            cursor: pointer;
            text-decoration: none;
            font-weight: 600;
            transition: all 0.3s ease;
            box-shadow: 0 4px 10px rgba(215, 204, 200, 0.3);
        }

        .btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 15px rgba(215, 204, 200, 0.4);
            background-color: #EFEBE9;
        }

        .btn-secondary {
            background: var(--secondary);
            color: var(--text);
            border: 2px solid var(--text-light);
            box-shadow: none;
        }

        .btn-secondary:hover {
            background: rgba(180, 152, 152, 0.1);
            color: var(--text);
        }

        /* Header & Navigation */
        header {
            background: linear-gradient(135deg, #8D6E63 0%, #5D4037 100%);
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
            position: fixed;
            width: 100%;
            top: 0;
            z-index: 1000;
            border-bottom: 2px solid var(--accent);
        }

        nav {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px 0;
            position: relative;
        }

        .logo-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
            flex: 1;
        }

        .logo {
            color: var(--accent);
            font-size: 1.8rem;
            font-weight: 700;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 5px;
            font-family: 'Raleway', sans-serif;
            letter-spacing: 1px;
        }

        .name-stack {
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
            line-height: 1.1;
        }

        .name-line {
            font-weight: 700;
            text-align: center;
        }

        .tagline {
            color: var(--light);
            font-size: 14px;
            text-shadow: #3E2723 1px 1px 2px;
            margin-top: 5px;
            letter-spacing: 1.5px;
            text-transform: uppercase;
            font-weight: 500;
            text-align: center;
        }

        .nav-links {
            display: flex;
            list-style: none;
            align-items: center;
        }

        .nav-links li {
            margin-left: 30px;
        }

        .nav-links a {
            text-decoration: none;
            color: var(--light);
            font-weight: 500;
            transition: color 0.3s ease;
            position: relative;
        }

        .nav-links a:after {
            content: '';
            position: absolute;
            bottom: -5px;
            left: 0;
            width: 0;
            height: 2px;
            background-color: var(--accent);
            transition: width 0.3s ease;
        }

        .nav-links a:hover {
            color: var(--accent);
        }

        .nav-links a:hover:after {
            width: 100%;
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .user-avatar {
            width: 40px;
            height: 40px;
            background: var(--accent);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--primary);
            font-weight: bold;
        }

        /* Mobile Menu */
        .mobile-menu-btn {
            display: none;
            background: none;
            border: none;
            color: var(--light);
            font-size: 1.5rem;
            cursor: pointer;
            margin-left: auto;
        }

        .mobile-menu {
            display: none;
            position: fixed;
            top: 0;
            right: 0;
            width: 250px;
            height: 100%;
            background: var(--secondary);
            z-index: 1001;
            padding: 20px;
            box-shadow: -5px 0 15px rgba(0, 0, 0, 0.3);
            overflow-y: auto;
        }

        .mobile-menu.active {
            display: block;
        }

        .mobile-menu-header {
            display: flex;
            justify-content: flex-end;
            margin-bottom: 30px;
            padding-bottom: 15px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .mobile-menu-close {
            background: none;
            border: none;
            color: var(--light);
            font-size: 1.5rem;
            cursor: pointer;
        }

        .mobile-nav-links {
            list-style: none;
        }

        .mobile-nav-links li {
            margin-bottom: 15px;
        }

        .mobile-nav-links a {
            color: var(--light);
            text-decoration: none;
            font-size: 1.1rem;
            display: block;
            padding: 10px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .mobile-user-info {
            margin-top: 30px;
            padding-top: 20px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }

        .mobile-user-info .user-avatar {
            margin-bottom: 10px;
        }

        /* Hero Section */
        .hero {
            background: linear-gradient(rgba(93, 64, 55, 0.7), rgba(93, 64, 55, 0.9)), 
                        url('https://images.unsplash.com/photo-1518837695005-2083093ee35b?auto=format&fit=crop&w=1200&q=80');
            background-size: cover;
            background-position: center;
            color: var(--light);
            padding: 160px 16px 90px;
            text-align: center;
            position: relative;
            overflow: visible;
            min-height: 100svh;
        }

        .hero h1 {
            color: var(--accent);
            margin-bottom: 20px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
        }

        .hero p {
            color: rgba(239, 235, 233, 0.9);
            font-size: 1.2rem;
            max-width: 700px;
            margin: 0 auto 30px;
        }

        .hero-btns {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 30px;
        }

        .hero-btns .btn {
            background-color: transparent;
            border: 2px solid var(--light);
            color: var(--light);
        }

        .hero-btns .btn:hover {
            background-color: var(--light);
            color: var(--primary);
        }

        .hero-btns .btn-primary {
            background-color: var(--accent);
            border-color: var(--accent);
            color: var(--primary);
        }

        .hero-btns .btn-primary:hover {
            background-color: var(--light);
            color: var(--accent);
        }

        /* Bible Quotations */
        .bible-quotations {
            background: linear-gradient(135deg, #8D6E63 0%, #5D4037 100%);
            padding: 60px 0;
            text-align: center;
        }

        .quotation-container {
            max-width: 800px;
            margin: 0 auto;
        }

        .bible-quote {
            font-style: italic;
            font-size: 1.3rem;
            margin-bottom: 30px;
            line-height: 1.8;
            color: var(--light);
            border-left: 3px solid var(--accent);
            padding-left: 20px;
        }

        .bible-verse {
            font-weight: 600;
            color: var(--accent);
            margin-top: 10px;
        }

        /* Services Section */
        .services {
            background: linear-gradient(135deg, #8D6E63 0%, #5D4037 100%);
        }

        .services-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 30px;
        }

        .service-item {
            background: rgba(255, 255, 255, 0.1);
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            text-align: center;
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .service-item::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 3px;
            background: linear-gradient(90deg, var(--accent), #EFEBE9);
        }

        .service-item:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.2);
            border-color: rgba(215, 204, 200, 0.3);
            background: rgba(255, 255, 255, 0.15);
        }

        .service-icon {
            font-size: 2.5rem;
            color: var(--accent);
            margin-bottom: 20px;
        }

        .service-item h3 {
            font-size: 1.3rem;
            margin-bottom: 15px;
            color: var(--accent);
        }

        .service-item p {
            color: var(--text-light);
        }

        /* Content Section */
        .content {
            background: linear-gradient(135deg, #8D6E63 0%, #5D4037 100%);
        }

        .content-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 30px;
        }

        .content-item {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .content-item:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.2);
            border-color: rgba(215, 204, 200, 0.3);
            background: rgba(255, 255, 255, 0.15);
        }

        .content-img {
            height: 200px;
            overflow: hidden;
        }

        .content-img img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.5s ease;
        }

        .content-item:hover .content-img img {
            transform: scale(1.05);
        }

        .video-container {
            position: relative;
            padding-bottom: 56.25%; /* 16:9 aspect ratio */
            height: 0;
            overflow: hidden;
        }

        .video-container iframe,
        .video-container video {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
        }

        .content-details {
            padding: 20px;
        }

        .content-details h3 {
            font-size: 1.2rem;
            margin-bottom: 10px;
            color: var(--accent);
        }

        .content-date {
            font-size: 0.9rem;
            color: var(--light);
            margin-bottom: 10px;
        }

        .content-author {
            font-size: 0.8rem;
            color: var(--light);
            font-style: italic;
        }

        /* Admin Panel */
        .admin-panel {
            background: rgba(255, 255, 255, 0.08);
            padding: 24px;
            border-radius: 12px;
            margin-bottom: 40px;
            border: 1px solid rgba(215, 204, 200, 0.25);
            box-shadow: 0 10px 24px rgba(0,0,0,0.2);
            backdrop-filter: blur(6px);
            position: relative;
        }

        .admin-panel h3 {
            color: var(--accent);
            margin-bottom: 20px;
        }

        .admin-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            position: sticky;
            top: -30px;
            background: rgba(93, 64, 55, 0.6);
            padding: 8px;
            border-radius: 10px;
            z-index: 10;
            backdrop-filter: blur(6px);
        }

        .admin-tab {
            flex: 1;
            padding: 12px 16px;
            background: rgba(255, 255, 255, 0.08);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 8px;
            color: var(--light);
            cursor: pointer;
            transition: all 0.2s ease;
            font-weight: 600;
        }

        .admin-tab.active {
            background: var(--accent);
            color: var(--primary);
            border-color: var(--accent);
            box-shadow: 0 4px 12px rgba(215, 204, 200, 0.3);
        }

        .admin-content {
            display: none;
        }

        .admin-content.active {
            display: block;
        }

        #uploadTab form {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }

        #uploadTab #fileUploadGroup,
        #uploadTab #contentTextGroup,
        #uploadTab #contentDescription {
            grid-column: 1 / -1;
        }

        #usersTab, #prayersTab {
            padding-top: 10px;
        }

        .list-card {
            background: rgba(255,255,255,0.1);
            padding: 15px;
            margin: 10px 0;
            border-radius: 8px;
            border: 1px solid rgba(255,255,255,0.15);
            transition: all 0.2s ease;
        }

        .list-card:hover {
            background: rgba(255,255,255,0.15);
            border-color: rgba(255,255,255,0.25);
            transform: translateY(-2px);
        }

        .list-row {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            gap: 15px;
        }

        .list-actions .btn, .list-actions .btn-secondary {
            padding: 6px 12px;
        }

        #uploadTab form {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }

        #uploadTab #fileUploadGroup,
        #uploadTab #contentTextGroup,
        #uploadTab #contentDescription {
            grid-column: 1 / -1;
        }

        #usersTab, #prayersTab {
            padding-top: 10px;
        }

        .list-card {
            background: rgba(255,255,255,0.1);
            padding: 15px;
            margin: 10px 0;
            border-radius: 8px;
            border: 1px solid rgba(255,255,255,0.15);
            transition: all 0.2s ease;
        }

        .list-card:hover {
            background: rgba(255,255,255,0.15);
            border-color: rgba(255,255,255,0.25);
            transform: translateY(-2px);
        }

        .list-row {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            gap: 15px;
        }

        .list-actions .btn, .list-actions .btn-secondary {
            padding: 6px 12px;
        }

        #uploadTab form {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }

        #uploadTab #fileUploadGroup,
        #uploadTab #contentTextGroup,
        #uploadTab #contentDescription {
            grid-column: 1 / -1;
        }

        #usersTab, #prayersTab {
            padding-top: 10px;
        }

        .list-card {
            background: rgba(255,255,255,0.1);
            padding: 15px;
            margin: 10px 0;
            border-radius: 8px;
            border: 1px solid rgba(255,255,255,0.15);
            transition: all 0.2s ease;
        }

        .list-card:hover {
            background: rgba(255,255,255,0.15);
            border-color: rgba(255,255,255,0.25);
            transform: translateY(-2px);
        }

        .list-row {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            gap: 15px;
        }

        .list-actions .btn, .list-actions .btn-secondary {
            padding: 6px 12px;
        }

        .admin-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: rgba(255, 255, 255, 0.1);
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .stat-number {
            font-size: 2rem;
            font-weight: bold;
            color: var(--accent);
            margin-bottom: 10px;
        }

        .stat-label {
            color: var(--text-light);
            font-size: 0.9rem;
        }

        /* Contact Section */
        .contact {
            background: linear-gradient(135deg, #8D6E63 0%, #5D4037 100%);
        }

        .contact-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 50px;
        }

        .contact-info {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .contact-item {
            display: flex;
            align-items: flex-start;
            gap: 15px;
        }

        .contact-icon {
            width: 50px;
            height: 50px;
            background: rgba(215, 204, 200, 0.1);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--accent);
            font-size: 1.2rem;
        }

        .contact-text h3 {
            margin-bottom: 5px;
            color: var(--accent);
        }

        .contact-text p {
            color: var(--light);
        }

        .contact-form {
            background: rgba(255, 255, 255, 0.1);
            padding: 30px;
            border-radius: 10px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-control {
            width: 100%;
            padding: 12px 15px;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 5px;
            color: var(--light);
            font-size: 1rem;
            transition: all 0.3s ease;
        }

        .form-control::placeholder {
            color: var(--light);
        }

        .form-control:focus {
            outline: none;
            border-color: var(--accent);
            background: rgba(255, 255, 255, 0.15);
        }

        select.form-control {
            background: rgba(255, 255, 255, 0.1);
            color: var(--light);
        }
        select.form-control:focus {
            background: rgba(255, 255, 255, 0.15);
        }
        select.form-control option {
            color: var(--primary);
            background: var(--light);
        }
        select.form-control optgroup {
            color: var(--primary);
            background: var(--light);
        }

        textarea.form-control {
            min-height: 120px;
            resize: vertical;
        }

        .contact-form-buttons {
            display: flex;
            gap: 15px;
            margin-top: 20px;
        }

        .contact-form-buttons .btn {
            flex: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        /* Footer */
        footer {
            background: linear-gradient(135deg, #8D6E63 0%, #5D4037 100%);
            padding: 40px 0;
            text-align: center;
            border-top: 2px solid var(--accent);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 20px;
        }

        .footer-logo {
            margin-bottom: 20px;
            font-size: 1.5rem;
            font-weight: 500;
            color: var(--light);
        }

        .footer-logo span {
            color: var(--accent);
            font-weight: 400;
            margin-left: 5px;
        }

        .social-links {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-bottom: 20px;
        }

        .social-link {
            width: 40px;
            height: 40px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--light);
            text-decoration: none;
            transition: all 0.3s ease;
        }

        .social-link:hover {
            background: var(--accent);
            color: var(--primary);
            transform: translateY(-3px);
        }

        .copyright {
            color: var(--accent);
            font-size: 0.9rem;
        }

        /* Modal Styles */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }

        .modal-content {
            background: white;
            padding: 30px;
            border-radius: 10px;
            text-align: center;
            max-width: 400px;
            width: 90%;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        }

        .modal h3 {
            color: #5D4037;
            margin-bottom: 15px;
            font-size: 1.3rem;
        }

        .modal p {
            color: #666;
            margin-bottom: 20px;
            line-height: 1.5;
        }

        .modal-close {
            background: #5D4037;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin-top: 15px;
            transition: background 0.3s ease;
        }

        .modal-close:hover {
            background: #8D6E63;
        }

        .modal-tabs {
            display: flex;
            margin-bottom: 20px;
            border-bottom: 1px solid #eee;
        }

        .modal-tab {
            flex: 1;
            padding: 10px;
            background: none;
            border: none;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .modal-tab.active {
            background: #5D4037;
            color: white;
        }

        .modal-form {
            display: none;
        }

        .modal-form.active {
            display: block;
        }

        /* Enhanced Auth Modal Styles */
        .auth-modal {
            max-width: 450px;
            padding: 0;
            border-radius: 15px;
            overflow: hidden;
            background: linear-gradient(135deg, #8D6E63 0%, #5D4037 100%);
            border: 1px solid rgba(215, 204, 200, 0.3);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
        }

        .auth-header {
            background: linear-gradient(135deg, rgba(93, 64, 55, 0.9) 0%, rgba(77, 50, 40, 0.9) 100%);
            padding: 30px;
            text-align: center;
            border-bottom: 1px solid rgba(215, 204, 200, 0.2);
        }

        .auth-header h3 {
            color: var(--accent);
            margin-bottom: 8px;
            font-size: 1.5rem;
        }

        .auth-header p {
            color: var(--text-light);
            margin: 0;
            font-size: 0.9rem;
        }

        .auth-tabs {
            display: flex;
            background: rgba(93, 64, 55, 0.8);
            border-bottom: 1px solid rgba(215, 204, 200, 0.2);
        }

        .auth-tab {
            flex: 1;
            padding: 15px;
            background: none;
            border: none;
            color: var(--text-light);
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 500;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .auth-tab.active {
            background: var(--accent);
            color: var(--primary);
            position: relative;
        }

        .auth-tab.active:after {
            content: '';
            position: absolute;
            bottom: -1px;
            left: 0;
            width: 100%;
            height: 2px;
            background: var(--primary);
        }

        .auth-tab:hover:not(.active) {
            background: rgba(215, 204, 200, 0.1);
            color: var(--accent);
        }

        .auth-forms {
            padding: 30px;
        }

        .auth-form {
            display: none;
        }

        .auth-form.active {
            display: block;
            animation: fadeIn 0.3s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .input-icon {
            position: relative;
            display: flex;
            align-items: center;
        }

        .input-icon i {
            position: absolute;
            left: 15px;
            color: var(--accent);
            z-index: 1;
        }

        .input-icon .form-control {
            padding-left: 45px;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: var(--light);
            border-radius: 8px;
            height: 50px;
            transition: all 0.3s ease;
        }

        .input-icon .form-control:focus {
            background: rgba(255, 255, 255, 0.15);
            border-color: var(--accent);
            box-shadow: 0 0 0 3px rgba(215, 204, 200, 0.2);
        }

        .input-icon .form-control::placeholder {
            color: var(--text-light);
        }

        .form-options {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin: 20px 0;
            font-size: 0.9rem;
        }

        .checkbox {
            display: flex;
            align-items: center;
            cursor: pointer;
            color: var(--text-light);
        }

        .checkbox input {
            display: none;
        }

        .checkmark {
            width: 18px;
            height: 18px;
            border: 2px solid var(--accent);
            border-radius: 4px;
            margin-right: 8px;
            position: relative;
            transition: all 0.3s ease;
        }

        .checkbox input:checked + .checkmark {
            background: var(--accent);
        }

        .checkbox input:checked + .checkmark:after {
            content: '✓';
            position: absolute;
            color: var(--primary);
            font-size: 12px;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
        }

        .forgot-password {
            color: var(--accent);
            text-decoration: none;
            transition: color 0.3s ease;
        }

        .forgot-password:hover {
            color: var(--light);
            text-decoration: underline;
        }

        .auth-btn {
            width: 100%;
            padding: 15px;
            border: none;
            border-radius: 8px;
            font-weight: 600;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            margin-bottom: 20px;
        }

        .login-btn {
            background: var(--accent);
            color: var(--primary);
        }

        .login-btn:hover {
            background: #EFEBE9;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(215, 204, 200, 0.4);
        }

        .register-btn {
            background: linear-gradient(135deg, #25D366, #128C7E);
            color: white;
        }

        .register-btn:hover {
            background: linear-gradient(135deg, #128C7E, #25D366);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(37, 211, 102, 0.4);
        }

        .auth-divider {
            text-align: center;
            margin: 25px 0;
            position: relative;
            color: var(--text-light);
            font-size: 0.9rem;
        }

        .auth-divider:before {
            content: '';
            position: absolute;
            top: 50%;
            left: 0;
            right: 0;
            height: 1px;
            background: rgba(255, 255, 255, 0.2);
        }

        .auth-divider span {
            background: linear-gradient(135deg, #8D6E63 0%, #5D4037 100%);
            padding: 0 15px;
            position: relative;
        }

        .social-auth {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }

        .social-btn {
            flex: 1;
            padding: 12px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 8px;
            background: rgba(255, 255, 255, 0.1);
            color: var(--light);
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            font-size: 0.9rem;
        }

        .social-btn:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: translateY(-1px);
        }

        .google-btn:hover {
            border-color: #DB4437;
            color: #DB4437;
        }

        .facebook-btn:hover {
            border-color: #4267B2;
            color: #4267B2;
        }

        .auth-footer {
            padding: 20px 30px;
            background: rgba(93, 64, 55, 0.8);
            border-top: 1px solid rgba(215, 204, 200, 0.2);
            text-align: center;
        }

        .auth-footer p {
            color: var(--text-light);
            font-size: 0.8rem;
            margin: 0;
        }

        .auth-close {
            position: absolute;
            top: 15px;
            right: 15px;
            background: rgba(255, 255, 255, 0.1);
            border: none;
            color: var(--light);
            width: 35px;
            height: 35px;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }

        .auth-close:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: rotate(90deg);
        }

        /* Password strength indicator */
        .password-strength {
            margin-top: 5px;
            height: 4px;
            border-radius: 2px;
            background: rgba(255, 255, 255, 0.1);
            overflow: hidden;
        }

        .strength-bar {
            height: 100%;
            width: 0%;
            transition: all 0.3s ease;
        }

        .strength-weak { background: #ff4757; width: 33%; }
        .strength-medium { background: #ffa502; width: 66%; }
        .strength-strong { background: #2ed573; width: 100%; }

        /* Mobile Styles */
        @media (max-width: 768px) {
            html { scroll-padding-top: 100px; }
            body { padding-top: 100px; }
            h1 {
                font-size: 2.2rem;
            }

            h2 {
                font-size: 1.8rem;
            }

            .hero {
                padding: 130px 12px 70px;
                min-height: 100svh;
                background-position: center;
            }

            .hero-btns {
                flex-direction: column;
                align-items: center;
            }

            .hero-btns .btn {
                width: 200px;
            }

            .services-container, .content-container {
                grid-template-columns: 1fr;
            }

            .contact-container {
                grid-template-columns: 1fr;
                gap: 30px;
            }

            .contact-form-buttons {
                flex-direction: column;
            }

            .nav-links {
                display: none;
            }

            .user-info {
                display: none;
            }

            .mobile-menu-btn {
                display: block;
            }

            .logo-container {
                align-items: center;
                text-align: center;
            }

            .admin-stats {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 480px) {
            html { scroll-padding-top: 90px; }
            body { padding-top: 90px; }
            h1 {
                font-size: 1.8rem;
            }

            h2 {
                font-size: 1.5rem;
            }

            .hero {
                padding: 110px 12px 55px;
                min-height: 100svh;
                background-position: center;
            }

            section {
                padding: 60px 0;
            }

            .container {
                width: 95%;
            }
        }

    </style>
</head>
<body>
    <!-- Background Pattern -->
    <div class="background-pattern"></div>

    <!-- Header & Navigation -->
    <header>
        <div class="container">
            <nav>
                <div class="logo-container">
                    <div class="logo">
                        <div class="name-stack">
                            <div class="name-line">CENTER OF KNOWLEDGE <span>AND SPIRITUAL ENRICHMENT</span></div>
                        </div>
                    </div>
                    <div class="tagline">Wisdom for Life, Faith for Eternity</div>
                </div>
                
                <ul class="nav-links">
                    <li><a href="#home">Home</a></li>
                    <li><a href="#services">What We Do</a></li>
                    <li><a href="#content">Resources</a></li>
                    <li><a href="#contact">Contact</a></li>
                    <li class="user-info" id="userInfo" style="display: none;">
                        <div class="user-avatar" id="userAvatar">U</div>
                        <span id="userName">User</span>
                        <button class="btn-secondary" onclick="logout()" style="padding: 8px 15px;">Logout</button>
                    </li>
                    <li id="authButtons">
                        <button class="btn-secondary" onclick="openAuthModal()" style="padding: 8px 15px;">Login/Register</button>
                    </li>
                </ul>
                
                <button class="mobile-menu-btn" id="mobileMenuBtn">
                    <i class="fas fa-bars"></i>
                </button>
            </nav>
        </div>
    </header>

    <!-- Mobile Menu -->
    <div class="mobile-menu" id="mobileMenu">
        <div class="mobile-menu-header">
            <button class="mobile-menu-close" id="mobileMenuClose">
                <i class="fas fa-times"></i>
            </button>
        </div>
        
        <ul class="mobile-nav-links">
            <li><a href="#home">Home</a></li>
            <li><a href="#services">What We Do</a></li>
            <li><a href="#content">Resources</a></li>
            <li><a href="#contact">Contact</a></li>
        </ul>
        
        <div class="mobile-user-info" id="mobileUserInfo" style="display: none;">
            <div class="user-avatar" id="mobileUserAvatar">U</div>
            <span id="mobileUserName" style="color: var(--light);">User</span>
            <button class="btn" onclick="logout()" style="margin-top: 15px; width: 100%;">Logout</button>
        </div>
        
        <div class="mobile-auth-buttons" id="mobileAuthButtons">
            <button class="btn" onclick="openAuthModal()" style="width: 100%;">Login/Register</button>
        </div>
    </div>

    <!-- Hero Section -->
    <section id="home" class="hero">
        <div class="container">
            <h1>CENTER OF KNOWLEDGE AND SPIRITUAL ENRICHMENT</h1>
            <p>Wisdom for Life, Faith for Eternity</p>
            <p>A place for spiritual growth, knowledge acquisition, and faith building through biblical teachings and practical life applications.</p>
            <div class="hero-btns">
                <a href="#services" class="btn">What We Do</a>
                <a href="#contact" class="btn btn-primary">Contact Us</a>
            </div>
        </div>
    </section>

    <!-- Bible Quotations -->
    <section class="bible-quotations">
        <div class="container">
            <div class="quotation-container">
                <div class="bible-quote">
                    "Your word is a lamp for my feet, a light on my path."
                    <div class="bible-verse">Psalms 119:105</div>
                </div>
                <div class="bible-quote">
                    "Be very careful, then, how you live—not as unwise but as wise, making the most of every opportunity, because the days are evil. Therefore do not be foolish, but understand what the Lord's will is."
                    <div class="bible-verse">Ephesians 5:15-17</div>
                </div>
            </div>
        </div>
    </section>

    <!-- Services Section -->
    <section id="services" class="services">
        <div class="container">
            <h2>What We Do Here</h2>
            <div class="services-container">
                <div class="service-item">
                    <div class="service-icon">
                        <i class="fas fa-hands-praying"></i>
                    </div>
                    <h3>Intercessory Prayers and Counseling</h3>
                    <p>Prayer support and spiritual guidance for life's challenges and decisions.</p>
                </div>
                <div class="service-item">
                    <div class="service-icon">
                        <i class="fas fa-cross"></i>
                    </div>
                    <h3>Re-building Your Faith in Christ Jesus</h3>
                    <p>Strengthening and renewing your relationship with Jesus Christ.</p>
                </div>
                <div class="service-item">
                    <div class="service-icon">
                        <i class="fas fa-book-bible"></i>
                    </div>
                    <h3>Spiritual Enrichment</h3>
                    <p>Deepening your spiritual life through biblical teachings and practices.</p>
                </div>
                <div class="service-item">
                    <div class="service-icon">
                        <i class="fas fa-trumpet"></i>
                    </div>
                    <h3>End-time Messages</h3>
                    <p>Biblical insights and teachings about the end times and Christ's return.</p>
                </div>
                <div class="service-item">
                    <div class="service-icon">
                        <i class="fas fa-home-heart"></i>
                    </div>
                    <h3>Family Life Education</h3>
                    <p>Guidance for building strong, Christ-centered families and relationships.</p>
                </div>
                <div class="service-item">
                    <div class="service-icon">
                        <i class="fas fa-users"></i>
                    </div>
                    <h3>Leadership Skills</h3>
                    <p>Developing leadership abilities based on biblical principles.</p>
                </div>
                <div class="service-item">
                    <div class="service-icon">
                        <i class="fas fa-heart"></i>
                    </div>
                    <h3>Relationship and Dating Knowledge</h3>
                    <p>Biblical wisdom for dating, marriage, and healthy relationships.</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Content Section -->
    <section id="content" class="content">
        <div class="container">
            <h2>Spiritual Resources</h2>
            
            <!-- Admin Panel (visible only to admin) -->
            <div class="admin-panel" id="adminPanel" style="display: none;">
                <h3>Admin Dashboard</h3>
                
                <!-- Admin Stats -->
                <div class="admin-stats">
                    <div class="stat-card">
                        <div class="stat-number" id="totalUsers">0</div>
                        <div class="stat-label">Total Users</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="totalContent">0</div>
                        <div class="stat-label">Total Content</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="pendingRequests">0</div>
                        <div class="stat-label">Prayer Requests</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="pendingApprovals">0</div>
                        <div class="stat-label">Pending Approvals</div>
                    </div>
                </div>
                
                <div class="admin-tabs">
                    <button class="admin-tab active" onclick="switchAdminTab('upload')">Upload Content</button>
                    <button class="admin-tab" onclick="switchAdminTab('users')">Manage Users</button>
                    <button class="admin-tab" onclick="switchAdminTab('prayers')">Prayer Requests</button>
                    <button class="admin-tab" onclick="switchAdminTab('analytics')">Analytics</button>
                </div>
                
                <div class="admin-content active" id="uploadTab">
                    <form id="uploadForm" enctype="multipart/form-data">
                        <div class="form-group">
                            <select id="contentType" class="form-control" required>
                                <option value="">Select Content Type</option>
                                <option value="video">Video</option>
                                <option value="image">Image</option>
                                <option value="writeup">Writeup</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <input type="text" id="contentTitle" class="form-control" placeholder="Title" required>
                        </div>
                        <div class="form-group">
                            <textarea id="contentDescription" class="form-control" placeholder="Description" required></textarea>
                        </div>
                        <div class="form-group" id="fileUploadGroup">
                            <input type="file" id="contentFile" class="form-control">
                        </div>
                        <div class="form-group" id="contentTextGroup" style="display: none;">
                            <textarea id="contentText" class="form-control" placeholder="Write your content here..." rows="10"></textarea>
                        </div>
                        <div class="form-group">
                            <label class="checkbox">
                                <input type="checkbox" id="contentPublic">
                                <span class="checkmark"></span>
                                Make this content public
                            </label>
                        </div>
                        <button type="submit" class="btn">Upload Content</button>
                    </form>
                </div>
                
                <div class="admin-content" id="usersTab">
                    <h4>User Management</h4>
                    <div id="usersList"></div>
                </div>
                
                <div class="admin-content" id="prayersTab">
                    <h4>Prayer Requests</h4>
                    <div id="prayersList"></div>
                </div>
                
                <div class="admin-content" id="analyticsTab">
                    <h4>Website Analytics</h4>
                    <div class="analytics-content">
                        <div class="stat-card">
                            <div class="stat-number" id="totalViews">0</div>
                            <div class="stat-label">Total Content Views</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number" id="activeUsers">0</div>
                            <div class="stat-label">Active Users (Last 30 days)</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number" id="popularContent">0</div>
                            <div class="stat-label">Most Popular Content Type</div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="content-container" id="contentContainer">
                <!-- Content will be loaded here -->
                <div class="content-item">
                    <div class="content-details">
                        <h3>Please Login to Access Resources</h3>
                        <p>Create an account or login to access our spiritual resources, videos, and teachings.</p>
                        <button class="btn" onclick="openAuthModal()">Login/Register</button>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Contact Section -->
    <section id="contact" class="contact">
        <div class="container">
            <h2>Contact Us</h2>
            <p style="text-align: center; max-width: 700px; margin: 0 auto 40px;">For prayers, counseling, spiritual enrichment, reach out with the contact information below.</p>
            <div class="contact-container">
                <div class="contact-info">
                    <div class="contact-item">
                        <div class="contact-icon">
                            <i class="fas fa-map-marker-alt"></i>
                        </div>
                        <div class="contact-text">
                            <h3>Location</h3>
                            <p>Abia State, Nigeria</p>
                        </div>
                    </div>
                    <div class="contact-item">
                        <div class="contact-icon">
                            <i class="fas fa-phone"></i>
                        </div>
                        <div class="contact-text">
                            <h3>Phone</h3>
                            <p><a href="tel:09072560420" class="clickable-phone" title="Click to call" style="color: var(--light);">09072560420</a></p>
                        </div>
                    </div>
                    <div class="contact-item">
                        <div class="contact-icon">
                            <i class="fas fa-envelope"></i>
                        </div>
                        <div class="contact-text">
                            <h3>Email</h3>
                            <p><a href="mailto:Wisdomadiele57@gmail.com" class="clickable-email" title="Click to send email" style="color: var(--light);">Wisdomadiele57@gmail.com</a></p>
                        </div>
                    </div>
                    <div class="contact-item">
                        <div class="contact-icon">
                            <i class="fab fa-whatsapp"></i>
                        </div>
                        <div class="contact-text">
                            <h3>WhatsApp</h3>
                            <p><a href="https://wa.me/2349072560420" class="clickable-whatsapp" title="Click to send message on WhatsApp" target="_blank" style="color: var(--light);">Send us messages directly on WhatsApp</a></p>
                        </div>
                    </div>
                </div>
                <div class="contact-form">
                    <form id="contactForm">
                        <div class="form-group">
                            <input type="text" id="contactName" name="name" class="form-control" placeholder="Your Name" required>
                        </div>
                        <div class="form-group">
                            <input type="email" id="contactEmail" name="email" class="form-control" placeholder="Your Email" required>
                        </div>
                        <div class="form-group">
                            <input type="text" id="contactSubject" name="subject" class="form-control" placeholder="Subject" required>
                        </div>
                        <div class="form-group">
                            <textarea id="contactMessage" name="message" class="form-control" placeholder="Your Message" required></textarea>
                        </div>
                        <div class="contact-form-buttons">
                            <button type="submit" class="btn">
                                <i class="fas fa-envelope"></i> Send Message
                            </button>
                            <button type="button" class="btn" onclick="sendWhatsAppMessage()" style="background-color: #25D366; color: white;">
                                <i class="fab fa-whatsapp"></i> Send via WhatsApp
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer>
        <div class="container">
            <div class="footer-logo">CENTER OF KNOWLEDGE <span>AND SPIRITUAL ENRICHMENT</span></div>
            <div class="social-links">
                <a href="#" class="social-link" title="Follow on Facebook" aria-label="Follow on Facebook"><i class="fab fa-facebook-f"></i></a>
                <a href="#" class="social-link" title="Follow on Twitter" aria-label="Follow on Twitter"><i class="fab fa-twitter"></i></a>
                <a href="#" class="social-link" title="Follow on Instagram" aria-label="Follow on Instagram"><i class="fab fa-instagram"></i></a>
                <a href="#" class="social-link" title="Subscribe on YouTube" aria-label="Subscribe on YouTube"><i class="fab fa-youtube"></i></a>
            </div>
            <p class="copyright">&copy; 2023 Center of Knowledge and Spiritual Enrichment. All Rights Reserved.</p>
        </div>
    </footer>

    <!-- Auth Modal -->
    <div class="modal" id="authModal">
        <div class="modal-content auth-modal">
            <div class="auth-header">
                <h3>Welcome to Spiritual Center</h3>
                <p>Join our spiritual community</p>
            </div>
            
            <div class="auth-tabs">
                <button class="auth-tab active" onclick="switchAuthTab('login')">
                    <i class="fas fa-sign-in-alt"></i>
                    Login
                </button>
                <button class="auth-tab" onclick="switchAuthTab('register')">
                    <i class="fas fa-user-plus"></i>
                    Register
                </button>
            </div>
            
            <div class="auth-forms">
                <form id="loginForm" class="auth-form active">
                    <div class="form-group">
                        <div class="input-icon">
                            <i class="fas fa-envelope"></i>
                            <input type="email" id="loginEmail" class="form-control" placeholder="Enter your email" required>
                        </div>
                    </div>
                    <div class="form-group">
                        <div class="input-icon">
                            <i class="fas fa-lock"></i>
                            <input type="password" id="loginPassword" class="form-control" placeholder="Enter your password" required>
                        </div>
                    </div>
                    <div class="form-options">
                        <label class="checkbox">
                            <input type="checkbox" id="rememberMe">
                            <span class="checkmark"></span>
                            Remember me
                        </label>
                        <a href="#" class="forgot-password">Forgot password?</a>
                    </div>
                    <button type="submit" class="auth-btn login-btn">
                        <i class="fas fa-sign-in-alt"></i>
                        Sign In
                    </button>
                    <div class="auth-divider">
                        <span>or continue with</span>
                    </div>
                    <div class="social-auth">
                        <button type="button" class="social-btn google-btn">
                            <i class="fab fa-google"></i>
                            Google
                        </button>
                        <button type="button" class="social-btn facebook-btn">
                            <i class="fab fa-facebook-f"></i>
                            Facebook
                        </button>
                    </div>
                </form>
                
                <form id="registerForm" class="auth-form">
                    <div class="form-group">
                        <div class="input-icon">
                            <i class="fas fa-user"></i>
                            <input type="text" id="registerUsername" class="form-control" placeholder="Choose a username" required>
                        </div>
                    </div>
                    <div class="form-group">
                        <div class="input-icon">
                            <i class="fas fa-envelope"></i>
                            <input type="email" id="registerEmail" class="form-control" placeholder="Enter your email" required>
                        </div>
                    </div>
                    <div class="form-group">
                        <div class="input-icon">
                            <i class="fas fa-lock"></i>
                            <input type="password" id="registerPassword" class="form-control" placeholder="Create a password" required>
                        </div>
                        <div class="password-strength">
                            <div class="strength-bar"></div>
                        </div>
                    </div>
                    <div class="form-group">
                        <div class="input-icon">
                            <i class="fas fa-lock"></i>
                            <input type="password" id="registerConfirmPassword" class="form-control" placeholder="Confirm password" required>
                        </div>
                    </div>
                    <div class="form-options">
                        <label class="checkbox">
                            <input type="checkbox" id="agreeTerms" required>
                            <span class="checkmark"></span>
                            I agree to the <a href="#">Terms of Service</a> and <a href="#">Privacy Policy</a>
                        </label>
                    </div>
                    <button type="submit" class="auth-btn register-btn">
                        <i class="fas fa-user-plus"></i>
                        Create Account
                    </button>
                </form>
            </div>
            
            <div class="auth-footer">
                <p>By joining, you agree to our spiritual community guidelines</p>
            </div>
            
            <button class="modal-close auth-close" onclick="closeAuthModal()">
                <i class="fas fa-times"></i>
            </button>
        </div>
    </div>
<script>
        // ================= CONFIGURATION START =================
    // Enhanced Configuration with better error handling
    const config = {
        development: {
            API_BASE: 'http://localhost:5000/api',
            BACKEND_URL: 'http://localhost:5000'
        },
        production: {
            API_BASE: 'https://spiritual-center.onrender.com/api',
            BACKEND_URL: 'https://spiritual-center.onrender.com'
        }
    };

    // Detect environment
    const isDevelopment = window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1';
    const currentConfig = isDevelopment ? config.development : config.production;

    // Global configuration with fallbacks
    window.API_BASE = currentConfig.API_BASE;
    window.BACKEND_URL = currentConfig.BACKEND_URL;

    console.log('🔧 Environment:', isDevelopment ? 'Development' : 'Production');
    console.log('🌐 API Base:', window.API_BASE);
    console.log('🚀 Backend URL:', window.BACKEND_URL);

    // Connection health check
    async function checkBackendHealth() {
        try {
            const response = await fetch(`${window.BACKEND_URL}/health`, {
                method: 'GET'
            });
            return response.ok;
        } catch (error) {
            console.warn('⚠️ Backend health check failed:', error.message);
            return false;
        }
    }

    // Make health check available globally
    window.checkBackendHealth = checkBackendHealth;
    // ================= CONFIGURATION END =================
    
    // Enhanced JavaScript for Spiritual Center Web Application
    // Use the configured API base
    let API_BASE = window.API_BASE;
    let BACKEND_URL = window.BACKEND_URL || API_BASE.replace('/api', '');
    console.log('🔧 API Base URL:', API_BASE);
    console.log('🌐 Backend URL:', BACKEND_URL);

    // Global state
    let currentUser = null;
    let authToken = localStorage.getItem('authToken');

    // Connection status monitoring
    let connectionStatus = {
        backend: false,
        database: false,
        lastCheck: null
    };

    // DOM Elements
    const authModal = document.getElementById('authModal');
    const userInfo = document.getElementById('userInfo');
    const authButtons = document.getElementById('authButtons');
    const userName = document.getElementById('userName');
    const userAvatar = document.getElementById('userAvatar');
    const adminPanel = document.getElementById('adminPanel');
    const contentContainer = document.getElementById('contentContainer');
    const mobileMenu = document.getElementById('mobileMenu');
    const mobileMenuBtn = document.getElementById('mobileMenuBtn');
    const mobileMenuClose = document.getElementById('mobileMenuClose');

    // Enhanced Debug function
    function debugLog(message, data = null) {
        const timestamp = new Date().toISOString();
        console.log(`🔍 [${timestamp}] ${message}`, data || '');
    }

    // Initialize app
    document.addEventListener('DOMContentLoaded', function() {
        debugLog('App initializing...');
        debugLog('Auth token exists:', !!authToken);
        
        // Show connection status
        showConnectionStatus('Checking server connection...', 'info');
        
        // Test backend first
        testBackendConnection().then(success => {
            if (success) {
                if (authToken) {
                    debugLog('Token found in localStorage');
                    validateTokenAndLoadUser();
                } else {
                    debugLog('No token found, loading public content');
                    loadPublicContent();
                }
            } else {
                // If backend fails, show error and try public content
                showConnectionStatus('Backend server not available. Showing limited functionality.', 'warning');
                loadPublicContent();
            }
        });
        
        setupEventListeners();
    });

    // Enhanced backend connection test
    async function testBackendConnection() {
        try {
            debugLog('Testing backend connection to:', `${BACKEND_URL}/health`);
            
            // Create abort controller for timeout
            const controller = new AbortController();
            const timeoutId = setTimeout(() => controller.abort(), 10000);
            
            const response = await fetch(`${BACKEND_URL}/health`, {
                method: 'GET',
                headers: {
                    'Content-Type': 'application/json',
                },
                signal: controller.signal
            });
            
            clearTimeout(timeoutId);
            
            debugLog('Backend response status:', response.status);
            
            if (!response.ok) {
                throw new Error(`HTTP ${response.status}: ${response.statusText}`);
            }
            
            const data = await response.json();
            debugLog('Backend connection successful:', data);
            
            connectionStatus.backend = true;
            connectionStatus.lastCheck = new Date();
            
            showConnectionStatus('Connected to server successfully!', 'success');
            return true;
            
        } catch (error) {
            console.error('❌ Backend connection failed:', error);
            connectionStatus.backend = false;
            connectionStatus.lastCheck = new Date();
            
            let errorMessage = 'Cannot connect to server. ';
            
            if (error.name === 'AbortError') {
                errorMessage = 'Server timeout. Backend might be starting up or experiencing high load.';
            } else if (error.message.includes('Failed to fetch')) {
                errorMessage = 'Network error. Please check your internet connection.';
            } else {
                errorMessage += error.message;
            }
            
            showConnectionStatus(errorMessage, 'warning');
            
            // Show troubleshooting tips
            showTroubleshootingTips();
            return false;
        }
    }

    // Show connection status to user
    function showConnectionStatus(message, type) {
        // Remove existing status message
        const existingStatus = document.getElementById('connectionStatus');
        if (existingStatus) {
            existingStatus.remove();
        }
        
        const statusDiv = document.createElement('div');
        statusDiv.id = 'connectionStatus';
        statusDiv.style.cssText = `
            position: fixed;
            top: 10px;
            left: 50%;
            transform: translateX(-50%);
            padding: 12px 20px;
            border-radius: 5px;
            color: white;
            z-index: 10001;
            font-weight: 500;
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
            max-width: 80%;
            text-align: center;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255,255,255,0.2);
        `;
        
        if (type === 'success') {
            statusDiv.style.background = 'linear-gradient(135deg, #4CAF50, #45a049)';
        } else if (type === 'error') {
            statusDiv.style.background = 'linear-gradient(135deg, #f44336, #d32f2f)';
        } else if (type === 'warning') {
            statusDiv.style.background = 'linear-gradient(135deg, #ff9800, #f57c00)';
        } else {
            statusDiv.style.background = 'linear-gradient(135deg, #2196F3, #1976D2)';
        }
        
        statusDiv.innerHTML = `
            <div style="display: flex; align-items: center; justify-content: center; gap: 10px;">
                <i class="fas ${type === 'success' ? 'fa-check-circle' : type === 'error' ? 'fa-exclamation-triangle' : type === 'warning' ? 'fa-exclamation-circle' : 'fa-info-circle'}"></i>
                <span>${message}</span>
                <button onclick="this.parentElement.parentElement.remove()" style="background: none; border: none; color: white; cursor: pointer; margin-left: 10px;">
                    <i class="fas fa-times"></i>
                </button>
            </div>
        `;
        
        document.body.appendChild(statusDiv);
        
        // Auto-remove success messages after 5 seconds
        if (type === 'success') {
            setTimeout(() => {
                if (document.body.contains(statusDiv)) {
                    statusDiv.remove();
                }
            }, 5000);
        }
    }

    // Show troubleshooting tips
    function showTroubleshootingTips() {
        const tips = `
            <div style="background: rgba(255,255,255,0.1); padding: 20px; border-radius: 10px; margin: 20px 0; border-left: 4px solid #ff9800;">
                <h4 style="margin-top: 0; color: #ffb74d;">Connection Issues Detected</h4>
                <p style="margin-bottom: 15px;">The backend server is currently unavailable. You can still:</p>
                <ol style="text-align: left; margin: 0; padding-left: 20px; margin-bottom: 15px;">
                    <li>Browse the website content</li>
                    <li>View our services and contact information</li>
                    <li>Use WhatsApp to contact us directly</li>
                </ol>
                <div style="display: flex; gap: 10px; flex-wrap: wrap;">
                    <button onclick="retryConnection()" class="btn" style="flex: 1; min-width: 120px;">
                        <i class="fas fa-sync-alt"></i> Retry Connection
                    </button>
                    <button onclick="loadPublicContent()" class="btn-secondary" style="flex: 1; min-width: 120px;">
                        <i class="fas fa-eye"></i> Continue Browsing
                    </button>
                </div>
            </div>
        `;
        
        // Add tips to content container if it exists
        if (contentContainer) {
            contentContainer.innerHTML = tips + contentContainer.innerHTML;
        }
    }

    // Retry connection function
    function retryConnection() {
        debugLog('Retrying connection...');
        showConnectionStatus('Retrying connection...', 'info');
        
        testBackendConnection().then(success => {
            if (success) {
                if (authToken) {
                    validateTokenAndLoadUser();
                } else {
                    loadPublicContent();
                }
            }
        });
    }

    // Enhanced token validation
    async function validateTokenAndLoadUser() {
        try {
            if (!authToken) {
                throw new Error('No token found');
            }
            
            // Basic token validation
            const payload = JSON.parse(atob(authToken.split('.')[1]));
            const currentTime = Date.now() / 1000;
            
            if (payload.exp < currentTime) {
                throw new Error('Token expired');
            }
            
            currentUser = payload;
            debugLog('Token validated, user:', currentUser);
            
            updateUI();
            loadContent();
            
            if (currentUser.role === 'admin') {
                debugLog('Admin user detected, loading admin data');
                loadAdminData();
            }
            
        } catch (error) {
            console.error('❌ Invalid token:', error);
            localStorage.removeItem('authToken');
            authToken = null;
            currentUser = null;
            updateUI();
            loadPublicContent();
            showMessage('Session expired. Please login again.', 'warning');
        }
    }

    function setupEventListeners() {
        // Auth forms
        const loginForm = document.getElementById('loginForm');
        const registerForm = document.getElementById('registerForm');
        const contactForm = document.getElementById('contactForm');
        
        if (loginForm) loginForm.addEventListener('submit', handleLogin);
        if (registerForm) registerForm.addEventListener('submit', handleRegister);
        if (contactForm) contactForm.addEventListener('submit', handleContact);
        
        // Admin forms
        const uploadForm = document.getElementById('uploadForm');
        const contentType = document.getElementById('contentType');
        
        if (uploadForm) {
            uploadForm.addEventListener('submit', handleUpload);
        }
        if (contentType) {
            contentType.addEventListener('change', handleContentTypeChange);
        }
        
        // Mobile menu
        if (mobileMenuBtn) {
            mobileMenuBtn.addEventListener('click', openMobileMenu);
        }
        if (mobileMenuClose) {
            mobileMenuClose.addEventListener('click', closeMobileMenu);
        }
        
        // Auth modal close when clicking outside
        if (authModal) {
            authModal.addEventListener('click', function(e) {
                if (e.target === authModal) {
                    closeAuthModal();
                }
            });
        }

        // Password strength indicator
        const registerPassword = document.getElementById('registerPassword');
        if (registerPassword) {
            registerPassword.addEventListener('input', updatePasswordStrength);
        }

        // Close mobile menu when clicking on links
        document.querySelectorAll('.mobile-nav-links a').forEach(link => {
            link.addEventListener('click', closeMobileMenu);
        });

        debugLog('Event listeners setup complete');
    }

    // Mobile menu functions
    function openMobileMenu() {
        if (mobileMenu) {
            mobileMenu.classList.add('active');
            document.body.style.overflow = 'hidden';
        }
    }

    function closeMobileMenu() {
        if (mobileMenu) {
            mobileMenu.classList.remove('active');
            document.body.style.overflow = '';
        }
    }

    // Auth functions
    function openAuthModal() {
        debugLog('Opening auth modal');
        if (authModal) {
            authModal.style.display = 'flex';
            document.body.style.overflow = 'hidden';
        }
    }

    function closeAuthModal() {
        debugLog('Closing auth modal');
        if (authModal) {
            authModal.style.display = 'none';
            document.body.style.overflow = '';
            
            const loginForm = document.getElementById('loginForm');
            const registerForm = document.getElementById('registerForm');
            if (loginForm) loginForm.reset();
            if (registerForm) registerForm.reset();
        }
    }

    function switchAuthTab(tab) {
        debugLog('Switching to tab:', tab);
        document.querySelectorAll('.auth-tab').forEach(t => t.classList.remove('active'));
        document.querySelectorAll('.auth-form').forEach(f => f.classList.remove('active'));
        
        const activeTab = document.querySelector(`.auth-tab[onclick="switchAuthTab('${tab}')"]`);
        const activeForm = document.getElementById(`${tab}Form`);
        
        if (activeTab) activeTab.classList.add('active');
        if (activeForm) activeForm.classList.add('active');
    }

    // Enhanced login handler
    async function handleLogin(e) {
        e.preventDefault();
        
        const email = document.getElementById('loginEmail').value;
        const password = document.getElementById('loginPassword').value;
        
        debugLog('Login attempt with email:', email);
        
        if (!email || !password) {
            showMessage('Please enter both email and password', 'error');
            return;
        }

        const loginBtn = document.querySelector('.login-btn');
        const originalText = loginBtn.innerHTML;
        loginBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Signing In...';
        loginBtn.disabled = true;
        
        try {
            const response = await fetch(`${API_BASE}/login`, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({ email, password })
            });
            
            const data = await response.json();
            debugLog('Login response:', data);
            
            if (response.ok) {
                authToken = data.token;
                localStorage.setItem('authToken', authToken);
                currentUser = data.user;
                
                debugLog('Login successful, user role:', currentUser.role);
                
                updateUI();
                loadContent();
                closeAuthModal();
                
                if (currentUser.role === 'admin') {
                    debugLog('Loading admin panel');
                    loadAdminData();
                }
                
                showMessage(`Welcome back, ${currentUser.username}!`, 'success');
            } else {
                showMessage(data.error || 'Login failed. Please try again.', 'error');
            }
        } catch (error) {
            console.error('❌ Login error:', error);
            showMessage('Network error. Please check your connection and try again.', 'error');
        } finally {
            loginBtn.innerHTML = originalText;
            loginBtn.disabled = false;
        }
    }

    // Enhanced registration handler
    async function handleRegister(e) {
        e.preventDefault();
        
        const username = document.getElementById('registerUsername').value;
        const email = document.getElementById('registerEmail').value;
        const password = document.getElementById('registerPassword').value;
        const confirmPassword = document.getElementById('registerConfirmPassword').value;
        
        if (password !== confirmPassword) {
            showMessage('Passwords do not match!', 'error');
            return;
        }
        
        if (password.length < 6) {
            showMessage('Password must be at least 6 characters long', 'error');
            return;
        }
        
        const registerBtn = document.querySelector('.register-btn');
        const originalText = registerBtn.innerHTML;
        registerBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Creating Account...';
        registerBtn.disabled = true;
        
        try {
            const response = await fetch(`${API_BASE}/register`, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({ username, email, password })
            });
            
            const data = await response.json();
            debugLog('Registration response:', data);
            
            if (response.ok) {
                showMessage('Registration successful! Please wait for admin approval.', 'success');
                document.getElementById('registerForm').reset();
                switchAuthTab('login');
            } else {
                showMessage(data.error || 'Registration failed. Please try again.', 'error');
            }
        } catch (error) {
            console.error('❌ Registration error:', error);
            showMessage('Network error. Please check your connection and try again.', 'error');
        } finally {
            registerBtn.innerHTML = originalText;
            registerBtn.disabled = false;
        }
    }

    function logout() {
        debugLog('Logging out user');
        localStorage.removeItem('authToken');
        authToken = null;
        currentUser = null;
        updateUI();
        closeMobileMenu();
        loadPublicContent();
        showMessage('Logged out successfully', 'success');
    }

    function updateUI() {
        if (currentUser) {
            debugLog('Updating UI for logged in user:', currentUser.username);
            userInfo.style.display = 'flex';
            authButtons.style.display = 'none';
            userName.textContent = currentUser.username;
            userAvatar.textContent = currentUser.username.charAt(0).toUpperCase();
            
            // Update mobile UI
            document.getElementById('mobileUserInfo').style.display = 'block';
            document.getElementById('mobileAuthButtons').style.display = 'none';
            document.getElementById('mobileUserName').textContent = currentUser.username;
            document.getElementById('mobileUserAvatar').textContent = currentUser.username.charAt(0).toUpperCase();
            
            if (currentUser.role === 'admin') {
                debugLog('Showing admin panel');
                adminPanel.style.display = 'block';
            } else {
                adminPanel.style.display = 'none';
            }
        } else {
            debugLog('Updating UI for logged out user');
            userInfo.style.display = 'none';
            authButtons.style.display = 'block';
            adminPanel.style.display = 'none';
            
            document.getElementById('mobileUserInfo').style.display = 'none';
            document.getElementById('mobileAuthButtons').style.display = 'block';
        }
    }

    // Enhanced content loading with better error handling
    async function loadContent() {
        if (!authToken) {
            showLoginPrompt();
            return;
        }
        
        try {
            debugLog('Loading authenticated content...');
            
            const response = await fetch(`${API_BASE}/content`, {
                headers: {
                    'Authorization': `Bearer ${authToken}`,
                    'Content-Type': 'application/json'
                }
            });
            
            debugLog('Content response status:', response.status);
            
            if (response.ok) {
                const content = await response.json();
                debugLog('Content loaded successfully:', content.length + ' items');
                renderContent(content);
            } else if (response.status === 401) {
                // Token expired or invalid
                debugLog('Token invalid, clearing and redirecting to public content');
                localStorage.removeItem('authToken');
                authToken = null;
                currentUser = null;
                updateUI();
                showLoginPrompt();
                showMessage('Session expired. Please login again.', 'warning');
            } else {
                throw new Error(`Failed to load content: ${response.status}`);
            }
        } catch (error) {
            console.error('❌ Content loading error:', error);
            contentContainer.innerHTML = `
                <div class="content-item">
                    <div class="content-details">
                        <h3>Error Loading Content</h3>
                        <p>${error.message}</p>
                        <div style="display: flex; gap: 10px; margin-top: 15px;">
                            <button class="btn" onclick="loadContent()">
                                <i class="fas fa-sync-alt"></i> Retry
                            </button>
                            <button class="btn-secondary" onclick="loadPublicContent()">
                                <i class="fas fa-eye"></i> View Public Content
                            </button>
                        </div>
                    </div>
                </div>
            `;
        }
    }

    async function loadPublicContent() {
        try {
            debugLog('Loading public content...');
            const response = await fetch(`${API_BASE}/content/public`);
            
            if (response.ok) {
                const content = await response.json();
                debugLog('Public content loaded:', content.length + ' items');
                renderContent(content);
            } else {
                showLoginPrompt();
            }
        } catch (error) {
            console.error('❌ Public content loading error:', error);
            showLoginPrompt();
        }
    }

    function showLoginPrompt() {
        if (contentContainer) {
            contentContainer.innerHTML = `
                <div class="content-item">
                    <div class="content-details">
                        <h3>Please Login to Access Resources</h3>
                        <p>Create an account or login to access our spiritual resources, videos, and teachings.</p>
                        <button class="btn" onclick="openAuthModal()">Login/Register</button>
                    </div>
                </div>
            `;
        }
    }

    function renderContent(content) {
        if (!contentContainer) return;
        
        if (content.length === 0) {
            contentContainer.innerHTML = `
                <div class="content-item">
                    <div class="content-details">
                        <h3>No Content Available Yet</h3>
                        <p>Check back later for new spiritual resources or contact the administrator.</p>
                        ${currentUser && currentUser.role === 'admin' ? 
                            `<button class="btn" onclick="switchAdminTab('upload')">Upload Content</button>` : 
                            ''
                        }
                    </div>
                </div>
            `;
            return;
        }
        
        contentContainer.innerHTML = content.map(item => createContentItem(item)).join('');
    }

    // Fixed content URL generation function
    function createContentItem(item) {
        let mediaContent = '';
        
        // Fix URL generation - handle cases where file_url might be null or already contain full URL
        let fileUrl = item.file_url;
        
        // If file_url exists and doesn't start with http, prepend the correct base
        if (fileUrl && !fileUrl.startsWith('http')) {
            // For uploads, we need to construct the full URL
            if (fileUrl.startsWith('/uploads/')) {
                fileUrl = `${BACKEND_URL}${fileUrl}`;
            }
        }
        
        if (item.type === 'video') {
            mediaContent = `
                <div class="video-container">
                    <video controls style="width: 100%; height: 100%;">
                        <source src="${fileUrl || ''}" type="video/mp4">
                        Your browser does not support the video tag.
                    </video>
                </div>
            `;
        } else if (item.type === 'image') {
            mediaContent = `
                <div class="content-img">
                    <img src="${fileUrl || ''}" alt="${item.title}" style="width: 100%; height: 100%; object-fit: cover;">
                </div>
            `;
        } else if (item.type === 'writeup') {
            // For writeups, we don't need media content, just show the text
            mediaContent = `
                <div class="content-img" style="background: linear-gradient(135deg, var(--secondary), var(--primary)); display: flex; align-items: center; justify-content: center; min-height: 200px;">
                    <i class="fas fa-file-alt" style="font-size: 3rem; color: var(--accent);"></i>
                </div>
            `;
        }
        
        return `
            <div class="content-item">
                ${mediaContent}
                <div class="content-details">
                    <h3>${item.title || 'Untitled'}</h3>
                    <div class="content-date">Posted: ${new Date(item.created_at).toLocaleDateString()}</div>
                    <div class="content-author">By: ${item.author || 'Admin'}</div>
                    <p>${item.description || 'No description available.'}</p>
                    ${item.type === 'writeup' && item.content_text ? `
                        <div class="writeup-content" style="margin-top: 15px; padding: 15px; background: rgba(255,255,255,0.1); border-radius: 5px; border-left: 3px solid var(--accent);">
                            ${item.content_text}
                        </div>
                    ` : ''}
                    ${!currentUser ? `
                        <p style="color: var(--accent); font-size: 0.9rem; margin-top: 10px;">
                            <i class="fas fa-lock"></i> Login to access more resources
                        </p>
                    ` : ''}
                </div>
            </div>
        `;
    }

    // WhatsApp message function
    function sendWhatsAppMessage() {
        const name = document.getElementById('contactName').value;
        const email = document.getElementById('contactEmail').value;
        const message = document.getElementById('contactMessage').value;
        
        if (!name || !email || !message) {
            showMessage('Please fill in all fields before sending via WhatsApp', 'error');
            return;
        }
        
        const whatsappMessage = `Hello, my name is ${name}. My email is ${email}. ${message}`;
        const encodedMessage = encodeURIComponent(whatsappMessage);
        const whatsappUrl = `https://wa.me/2349072560420?text=${encodedMessage}`;
        
        window.open(whatsappUrl, '_blank');
        showMessage('WhatsApp is opening with your message. Please send it to complete the process.', 'success');
    }

    // Admin functions
    function switchAdminTab(tab) {
        debugLog('Switching admin tab to:', tab);
        document.querySelectorAll('.admin-tab').forEach(t => t.classList.remove('active'));
        document.querySelectorAll('.admin-content').forEach(c => c.classList.remove('active'));
        
        const activeTab = document.querySelector(`.admin-tab[onclick="switchAdminTab('${tab}')"]`);
        const activeContent = document.getElementById(`${tab}Tab`);
        
        if (activeTab) activeTab.classList.add('active');
        if (activeContent) activeContent.classList.add('active');
    }

    function handleContentTypeChange() {
        const type = document.getElementById('contentType').value;
        const fileGroup = document.getElementById('fileUploadGroup');
        const textGroup = document.getElementById('contentTextGroup');
        
        if (type === 'writeup') {
            fileGroup.style.display = 'none';
            textGroup.style.display = 'block';
        } else {
            fileGroup.style.display = 'block';
            textGroup.style.display = 'none';
        }
    }

    async function handleUpload(e) {
        e.preventDefault();
        
        if (!currentUser || currentUser.role !== 'admin') {
            showMessage('Admin access required', 'error');
            return;
        }
        
        const formData = new FormData();
        formData.append('title', document.getElementById('contentTitle').value);
        formData.append('description', document.getElementById('contentDescription').value);
        formData.append('type', document.getElementById('contentType').value);
        formData.append('is_public', document.getElementById('contentPublic').checked);
        
        const type = document.getElementById('contentType').value;
        if (type === 'writeup') {
            formData.append('content_text', document.getElementById('contentText').value);
        } else {
            const fileInput = document.getElementById('contentFile');
            if (fileInput.files.length === 0) {
                showMessage('Please select a file for upload', 'error');
                return;
            }
            formData.append('file', fileInput.files[0]);
        }
        
        try {
            const response = await fetch(`${API_BASE}/content`, {
                method: 'POST',
                headers: {
                    'Authorization': `Bearer ${authToken}`
                },
                body: formData
            });
            
            const data = await response.json();
            
            if (response.ok) {
                showMessage('Content uploaded successfully!', 'success');
                document.getElementById('uploadForm').reset();
                loadContent();
                loadAdminData();
            } else {
                showMessage(data.error, 'error');
            }
        } catch (error) {
            console.error('Upload error:', error);
            showMessage('Upload failed. Please try again.', 'error');
        }
    }

    async function loadAdminData() {
        if (!currentUser || currentUser.role !== 'admin') {
            debugLog('User is not admin, skipping admin data load');
            return;
        }
        
        debugLog('Loading admin data...');
        
        try {
            const [usersResponse, prayersResponse, contentResponse] = await Promise.all([
                fetch(`${API_BASE}/users`, { headers: { 'Authorization': `Bearer ${authToken}` } }),
                fetch(`${API_BASE}/prayer-requests`, { headers: { 'Authorization': `Bearer ${authToken}` } }),
                fetch(`${API_BASE}/content`, { headers: { 'Authorization': `Bearer ${authToken}` } })
            ]);

            if (usersResponse.ok) {
                const users = await usersResponse.json();
                renderUsers(users);
                updateAdminStats(users, null, null);
            }

            if (prayersResponse.ok) {
                const prayers = await prayersResponse.json();
                renderPrayers(prayers);
                updateAdminStats(null, prayers, null);
            }

            if (contentResponse.ok) {
                const content = await contentResponse.json();
                updateAdminStats(null, null, content);
            }

            debugLog('Admin data loaded successfully');

        } catch (error) {
            console.error('❌ Admin data loading error:', error);
        }
    }

    function updateAdminStats(users, prayers, content) {
        if (users) {
            document.getElementById('totalUsers').textContent = users.length;
            const pendingApprovals = users.filter(user => !user.is_approved).length;
            document.getElementById('pendingApprovals').textContent = pendingApprovals;
        }
        
        if (prayers) {
            document.getElementById('pendingRequests').textContent = prayers.length;
        }
        
        if (content) {
            document.getElementById('totalContent').textContent = content.length;
            
            const contentTypes = {
                video: content.filter(item => item.type === 'video').length,
                image: content.filter(item => item.type === 'image').length,
                writeup: content.filter(item => item.type === 'writeup').length
            };
            
            let popularType = 'None';
            let maxCount = 0;
            for (const [type, count] of Object.entries(contentTypes)) {
                if (count > maxCount) {
                    maxCount = count;
                    popularType = type.charAt(0).toUpperCase() + type.slice(1);
                }
            }
            
            document.getElementById('popularContent').textContent = popularType;
            document.getElementById('totalViews').textContent = content.length * 5;
            document.getElementById('activeUsers').textContent = Math.floor(content.length * 0.7);
        }
    }

    function renderUsers(users) {
        const usersList = document.getElementById('usersList');
        if (!usersList) return;
        
        usersList.innerHTML = users.map(user => `
            <div class="list-card">
                <div class="list-row">
                    <div class="list-primary">
                        <strong>${user.username}</strong> (${user.email})<br>
                        <small>Role: ${user.role} | Approved: ${user.is_approved ? 'Yes' : 'No'} | Joined: ${new Date(user.created_at).toLocaleDateString()}</small>
                    </div>
                    <div class="list-actions">
                        ${!user.is_approved ? `<button class="btn" onclick="approveUser(${user.id})">Approve</button>` : ''}
                        <button class="btn-secondary" onclick="deleteUser(${user.id})">Delete</button>
                    </div>
                </div>
            </div>
        `).join('');
    }

    function renderPrayers(prayers) {
        const prayersList = document.getElementById('prayersList');
        if (!prayersList) return;
        
        prayersList.innerHTML = prayers.map(prayer => `
            <div class="list-card">
                <div class="list-row">
                    <div class="list-primary">
                        <strong>${prayer.name}</strong> (${prayer.email})<br>
                        <strong>Subject:</strong> ${prayer.subject}<br>
                        <strong>Message:</strong> ${prayer.message}<br>
                        <small>Status: ${prayer.status || 'Pending'} | Submitted: ${new Date(prayer.created_at).toLocaleDateString()}</small>
                    </div>
                    <div class="list-actions">
                        <button class="btn" onclick="markPrayerAsRead(${prayer.id})">Mark as Read</button>
                        <button class="btn-secondary" onclick="deletePrayer(${prayer.id})">Delete</button>
                    </div>
                </div>
            </div>
        `).join('');
    }

    async function approveUser(userId) {
        try {
            const response = await fetch(`${API_BASE}/users/${userId}/approve`, {
                method: 'PUT',
                headers: {
                    'Authorization': `Bearer ${authToken}`,
                    'Content-Type': 'application/json'
                }
            });
            
            if (response.ok) {
                showMessage('User approved successfully!', 'success');
                loadAdminData();
            } else {
                showMessage('Failed to approve user', 'error');
            }
        } catch (error) {
            showMessage('Failed to approve user', 'error');
        }
    }

    async function deleteUser(userId) {
        if (confirm('Are you sure you want to delete this user?')) {
            try {
                const response = await fetch(`${API_BASE}/users/${userId}`, {
                    method: 'DELETE',
                    headers: {
                        'Authorization': `Bearer ${authToken}`,
                        'Content-Type': 'application/json'
                    }
                });
                
                if (response.ok) {
                    showMessage('User deleted successfully!', 'success');
                    loadAdminData();
                } else {
                    showMessage('Failed to delete user', 'error');
                }
            } catch (error) {
                showMessage('Failed to delete user', 'error');
            }
        }
    }

    async function markPrayerAsRead(prayerId) {
        try {
            const response = await fetch(`${API_BASE}/prayer-requests/${prayerId}/read`, {
                method: 'PUT',
                headers: {
                    'Authorization': `Bearer ${authToken}`,
                    'Content-Type': 'application/json'
                }
            });
            
            if (response.ok) {
                showMessage('Prayer request marked as read!', 'success');
                loadAdminData();
            } else {
                showMessage('Failed to update prayer request', 'error');
            }
        } catch (error) {
            showMessage('Failed to update prayer request', 'error');
        }
    }

    async function deletePrayer(prayerId) {
        if (confirm('Are you sure you want to delete this prayer request?')) {
            try {
                const response = await fetch(`${API_BASE}/prayer-requests/${prayerId}`, {
                    method: 'DELETE',
                    headers: {
                        'Authorization': `Bearer ${authToken}`,
                        'Content-Type': 'application/json'
                    }
                });
                
                if (response.ok) {
                    showMessage('Prayer request deleted successfully!', 'success');
                    loadAdminData();
                } else {
                    showMessage('Failed to delete prayer request', 'error');
                }
            } catch (error) {
                showMessage('Failed to delete prayer request', 'error');
            }
        }
    }

    // Contact form handler
    async function handleContact(e) {
        e.preventDefault();
        
        const name = document.getElementById('contactName').value;
        const email = document.getElementById('contactEmail').value;
        const subject = document.getElementById('contactSubject').value;
        const message = document.getElementById('contactMessage').value;
        const userId = currentUser ? currentUser.id : null;
        
        try {
            const response = await fetch(`${API_BASE}/prayer-requests`, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({ name, email, subject, message, userId })
            });
            
            const data = await response.json();
            
            if (response.ok) {
                showMessage('Prayer request submitted successfully! We will contact you soon.', 'success');
                document.getElementById('contactForm').reset();
            } else {
                showMessage(data.error, 'error');
            }
        } catch (error) {
            showMessage('Submission failed. Please try again.', 'error');
        }
    }

    // Utility functions
    function showMessage(message, type) {
        const toast = document.createElement('div');
        toast.style.cssText = `
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 20px;
            border-radius: 5px;
            color: white;
            z-index: 10000;
            font-weight: 500;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            transition: all 0.3s ease;
            max-width: 400px;
            word-wrap: break-word;
        `;
        
        toast.style.background = type === 'success' ? '#4CAF50' : 
                                type === 'warning' ? '#ff9800' : '#f44336';
        toast.textContent = message;
        document.body.appendChild(toast);
        
        setTimeout(() => {
            toast.style.opacity = '0';
            setTimeout(() => {
                if (document.body.contains(toast)) {
                    document.body.removeChild(toast);
                }
            }, 300);
        }, 4000);
    }

    function updatePasswordStrength(e) {
        const password = e.target.value;
        const strengthBar = document.querySelector('.strength-bar');
        
        if (!strengthBar) return;
        
        let strength = 'weak';
        let strengthText = 'Weak';
        
        if (password.length >= 8) {
            strength = 'medium';
            strengthText = 'Medium';
        }
        if (password.length >= 12 && /[A-Z]/.test(password) && /[0-9]/.test(password) && /[^A-Za-z0-9]/.test(password)) {
            strength = 'strong';
            strengthText = 'Strong';
        }
        
        strengthBar.className = 'strength-bar strength-' + strength;
        strengthBar.setAttribute('title', strengthText);
    }

    // Smooth scrolling for navigation links
    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener('click', function (e) {
            e.preventDefault();
            
            const targetId = this.getAttribute('href');
            if (targetId === '#') return;
            
            const targetElement = document.querySelector(targetId);
            if (targetElement) {
                window.scrollTo({
                    top: targetElement.offsetTop - 70,
                    behavior: 'smooth'
                });
            }
        });
    });
</script>
</body>
</html>